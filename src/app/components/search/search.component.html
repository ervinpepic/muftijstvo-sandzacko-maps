<div class="m-1">
  <div class="input-group mt-2 mt-lg-0">
    <span
      *ngIf="searchQuery === ''; else showCountNumber"
      id="searchIcon"
      class="input-group-text"
      aria-label="search icon"
    >
      <i class="fas fa-search-location fa-lg" style="color: #27a27a"></i>
    </span>
    <ng-template #showCountNumber>
      <span class="input-group-text" id="searchCountNumber">
        {{ suggestionsList.length }}
      </span>
    </ng-template>
    <input
      class="form-control"
      type="search"
      name="searchQuery"
      aria-label="Search"
      role="combobox"
      aria-haspopup="listbox"
      aria-controls="suggestion-list"
      aria-describedby="searchIcon searchCountNumber"
      placeholder="Naziv vakufa | broj parcele"
      autocomplete="off"
      [(ngModel)]="searchQuery"
      (input)="updateMarkersVisibility(); handleInputChange(searchQuery)"
      (keydown)="navigateWithArrows($event, selectedSuggestionIndex)"
    />
  </div>
  <div
    class="input-group mt-1"
    *ngIf="isSuggestionsVisible"
    role="listbox"
    aria-live="assertive"
    aria-atomic="true"
    id="suggestion-list"
  >
    <div
      *ngIf="suggestionsList.length === 0"
      class="list-group search-suggestions"
    >
      <span class="list-group-item text-muted"
        >Nema vakufa za unijeti kriterijum</span
      >
    </div>
    <cdk-virtual-scroll-viewport
      class="list-group search-suggestions"
      [itemSize]="50"
      [maxBufferPx]="200"
    >
      <div
        *cdkVirtualFor="let suggestion of suggestionsList; let i = index"
        class="list-group-item hover-effect"
        [ngStyle]="{
          'background-color': i === selectedSuggestionIndex ? '#86b7fe' : '',
          color: i === selectedSuggestionIndex ? '#FFF' : '',
          'border-color': i === selectedSuggestionIndex ? '#86b7fe' : '',
          'box-shadow':
            i === selectedSuggestionIndex
              ? '0 0 0 0.25rem rgba(13, 110, 253, 0.25)'
              : ''
        }"
        role="option"
        aria-labelledby="suggestions-label"
        [attr.tabindex]="i === selectedSuggestionIndex ? '0' : '-1'"
        (click)="selectSearchSuggestion(suggestion)"
        (keydown)="navigateWithArrows($event, i)"
      >
        <span
          [innerHTML]="
            suggestion | highlightSearchTerm : searchQuery || 'Učitavanje'
          "
        ></span>
      </div>
    </cdk-virtual-scroll-viewport>
  </div>
</div>
